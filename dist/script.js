"use strict";(()=>{async function L(){return console.log("gameLayout called"),new Promise(n=>{let d=document.querySelector("body"),e=document.createElement("h1");e.style.fontFamily="Pixelify Sans, Rubik Broken Fax",e.textContent="BattleShip",e.classList.add("text-5xl","font-extrabold","text-center","mb-10","mt-10"),d?.appendChild(e);let o=document.createElement("div");o.setAttribute("id","gameLayout"),o.classList.add("flex","w-full","h-full","gap-10","p-10"),d?.appendChild(o);let l=document.createElement("div");l.setAttribute("id","playerBoard"),l.classList.add("grid","column-gap-0","border-2","border-black","mx-auto","my-auto"),w(l),o.appendChild(l);let a=document.createElement("div");a.setAttribute("id","computerBoard"),a.classList.add("grid","column-gap-0","border-2","border-black","mx-auto","my-auto"),w(a),o.appendChild(a),n()})}function w(n){for(let d=0;d<10;d++){for(let e=0;e<10;e++){let o=document.createElement("div");o.classList.add("w-10","h-10","border-2","border-black"),o.setAttribute("row",`${d}`),o.setAttribute("col",`${e}`),o.setAttribute("id","square"),o.innerHTML="",n.appendChild(o)}n.style.gridTemplateColumns="repeat(10, [col-start] 1fr [col-end])"}}async function v(){return console.log("startGame called"),new Promise(n=>{let d=document.querySelector("body"),e=document.createElement("modal");e.setAttribute("id","modal");let o=document.createElement("div");o.classList.add("fixed","left-0","top-0","flex","h-full","w-full","items-center","justify-center","bg-black","bg-opacity-50","py-10"),e.appendChild(o);let l=document.createElement("div");l.classList.add("max-h-full","w-full","max-w-xl","overflow-y-auto","sm:rounded-2xl","bg-white"),o.appendChild(l);let a=document.createElement("div");a.classList.add("w-full"),l.appendChild(a);let r=document.createElement("div");r.classList.add("m-8","my-20","max-w-[400px]","mx-auto"),a.appendChild(r);let t=document.createElement("div");t.classList.add("mb-8","text-center"),r.appendChild(t);let s=document.createElement("h1");s.classList.add("mb-4","text-3xl","font-extrabold"),s.textContent="BattleShip Game",t.appendChild(s);let m=document.createElement("p");m.classList.add("text-gray-600"),m.textContent="Embark on an epic naval adventure, a thrilling Battleship game that pits you against an intelligent opponent in a strategic battle for naval supremacy.",t.appendChild(m);let c=document.createElement("div");c.classList.add("space-y-4"),r.appendChild(c);let i=document.createElement("button");i.classList.add("p-3","bg-black","rounded-full","text-white","w-full","font-semibold"),i.textContent="Start Game",i.setAttribute("id","startButton"),i.addEventListener("click",()=>{e.remove(),n(),console.log("startGame ended")}),c.appendChild(i),d?.appendChild(e)})}async function S(){return console.log("readyToStart called"),new Promise(n=>{let d=document.querySelector("body"),e=document.createElement("modal");e.setAttribute("id","modal");let o=document.createElement("div");o.classList.add("fixed","left-0","top-0","flex","h-full","w-full","items-center","justify-center","bg-black","bg-opacity-50","py-10"),e.appendChild(o);let l=document.createElement("div");l.classList.add("max-h-full","w-full","max-w-xl","overflow-y-auto","sm:rounded-2xl","bg-white"),o.appendChild(l);let a=document.createElement("div");a.classList.add("w-full"),l.appendChild(a);let r=document.createElement("div");r.classList.add("m-8","my-20","max-w-[400px]","mx-auto"),a.appendChild(r);let t=document.createElement("div");t.classList.add("mb-8","text-center"),r.appendChild(t);let s=document.createElement("h1");s.classList.add("mb-4","text-3xl","font-extrabold"),s.textContent="Ready to play?",t.appendChild(s);let m=document.createElement("p");m.classList.add("text-gray-600"),m.textContent="Remember, the goal of this game is to sink all of your opponent's ships before they sink yours. If you hit a ship in the head, you sink it. Good luck!",t.appendChild(m);let c=document.createElement("div");c.classList.add("space-y-4"),r.appendChild(c);let i=document.createElement("button");i.classList.add("p-3","bg-black","rounded-full","text-white","w-full","font-semibold"),i.textContent="Start",i.setAttribute("id","startButton"),i.addEventListener("click",()=>{e.remove(),n()}),c.appendChild(i),d?.appendChild(e)})}function f(){let n=document.querySelector("body"),d=document.createElement("modal");d.setAttribute("id","modal");let e=document.createElement("div");e.classList.add("fixed","left-0","top-0","flex","h-full","w-full","items-center","justify-center","bg-black","bg-opacity-50","py-10"),d.appendChild(e);let o=document.createElement("div");o.classList.add("max-h-full","w-full","max-w-xl","overflow-y-auto","sm:rounded-2xl","bg-white"),e.appendChild(o);let l=document.createElement("div");l.classList.add("w-full"),o.appendChild(l);let a=document.createElement("div");a.classList.add("m-8","my-20","max-w-[400px]","mx-auto"),l.appendChild(a);let r=document.createElement("div");r.classList.add("mb-8","text-center"),a.appendChild(r);let t=document.createElement("h1");t.classList.add("mb-4","text-3xl","font-extrabold"),t.textContent="Do you want to play again?",r.appendChild(t);let s=document.createElement("p");s.classList.add("text-gray-600"),r.appendChild(s);let m=document.createElement("div");m.classList.add("space-y-4"),a.appendChild(m);let c=document.createElement("button");c.classList.add("p-3","bg-black","rounded-full","text-white","w-full","font-semibold"),c.textContent="Restart",c.setAttribute("id","restartButton"),c.addEventListener("click",()=>{d.remove(),B()}),m.appendChild(c),n?.appendChild(d)}function B(){window.location.reload()}var g=()=>{let n=Array.from({length:10},()=>Array(10).fill("")),d=[],e=[],o=(t,s,m,c)=>{if(a(t,s,m,c)){let i;for(let u=0;u<t.length;u++){let p=c?s+u:s,b=c?m:m+u;n[p][b]="#",i={row:p,col:b},t.coordinates=i}d.push(t),console.log(t)}else console.log("Invalid ship placement")},l=(t,s)=>{if(n[t][s]=="#"){alert("Hit a ship!");let c=i=>{i.target.classList.add("bg-red-500"),removeEventListener("click",c)};addEventListener("click",c),d.forEach(i=>{i.coordinates.row==t&&i.coordinates.col==s&&(i.isSunk=!0,alert("Head of the ship is hit!"))})}else e.push({row:t,col:s}),console.log("Missed the target!")},a=(t,s,m,c)=>{let i=c?s+t.length-1:s,u=c?m:m+t.length-1;if(i>=10||u>=10)return!1;for(let p=s;p<=i;p++)for(let b=m;b<=u;b++)if(n[p][b]==="#")return!1;return!0};return{placeShip:o,receiveAttack:l,areAllShipsSunk:()=>{let t=0;return d.forEach(s=>{s.isSunk==!0&&t++}),t==d.length?(console.log("All ships are sunk"),!0):!1},grid:n,ships:d,missedAttacks:e}};var k=n=>({attack(d,e){n.receiveAttack(d,e)}}),E=n=>{let d=[],e=G(),o,l=()=>{if(e.length>0){let a=Math.floor(Math.random()*e.length);if(o=e[a],d.includes(o))return l();d.push(o)}else console.log("No available coordinates");return o};return{attack(){this.array=[];let a=l();this.array.push(a.row,a.col),n.receiveAttack(a.row,a.col)},array:[]}};function G(){let n=[];for(let d=0;d<10;d++)for(let e=0;e<10;e++)n.push({row:d,col:e});return n}var y=n=>({length:n,coordinates:{row:0,col:0},hits:0,isSunk:!1,hit(){this.hits+=1,this.hits===this.length?(this.isSunk=!0,console.log("Ship is sunck")):console.log("Ship hit")}});var C=async(n,d,e)=>n?.id==="computerBoard"?new Promise(o=>{let l=a=>{let r=a.target.getAttribute("row"),t=a.target.getAttribute("col");d.attack(r,t),a.target.classList.contains("bg-green-500")?(a.target.classList.remove("bg-green-500"),a.target.classList.add("bg-red-500")):a.target.classList.add("bg-gray-500"),n?.removeEventListener("click",l),o()};n?.addEventListener("click",l)}):new Promise(o=>{e.attack();let l=n?.querySelector(`[row="${e.array[0]}"][col="${e.array[1]}"]`);l?.classList.contains("bg-green-500")?(l.classList.remove("bg-green-500"),l.classList.add("bg-red-500")):l?.classList.add("bg-gray-500"),o()}),A=()=>{let n=0;return new Promise(d=>{let e=document.getElementById("playerBoard"),o=[],l,a,r=!1,t=0,s=m=>{if(n===0)l=m.target;else if(n===1){if(a=m.target,l.getAttribute("row")===a.getAttribute("row")){t=Math.abs(Number(l.getAttribute("col"))-Number(a.getAttribute("col"))),r=!1;let c=Number(l.getAttribute("row")),i=Number(l.getAttribute("col"));o.push(t+1,r,c,i)}else if(l.getAttribute("col")===a.getAttribute("col")){t=Math.abs(Number(l.getAttribute("row"))-Number(a.getAttribute("row"))),r=!0;let c=Number(l.getAttribute("row")),i=Number(l.getAttribute("col"));o.push(t+1,r,c,i)}}n++,n===2&&(e?.removeEventListener("click",s),d(o))};e?.addEventListener("click",s)})},h=()=>Math.floor(Math.random()*9)+1,x=(n,d,e,o,l)=>{for(let a=0;a<d.length;a++){let r=l?e+a:e,t=l?o:o+a;n?.querySelector(`[row="${r}"][col="${t}"]`)?.classList.add("bg-green-500")}};document.addEventListener("DOMContentLoaded",async()=>{await v().then(()=>{L().then(()=>{console.log("gameLayout ended"),setTimeout(()=>alert("Let's place your ships, first ship is one square long!"),1e3)})});let n=document.getElementById("playerBoard"),d=document.getElementById("computerBoard"),e=g(),o=g(),l=k(o),a=E(e);for(let r=1;r<6;r++){let t=await A();if(t[0]!=r)alert("Invalid ship length, please try again"),r--;else{r>=1&&r<5&&alert("Place the next ship of "+(r+1)+" square length!");let s=y(r);e.placeShip(s,t[2],t[3],t[1]),x(n,s,t[2],t[3],t[1])}}for(let r=1;r<6;r++){let t=[],s=h(),m=h(),c=!1,i=[s,m];t.forEach(p=>{p===i&&(s=h(),m=h(),i=[s,m],t.push(i))}),i[0]>6?c=!1:(i[1]>6||Math.floor(Math.random()*2)===0&&(c=!1),c=!0);let u=y(r);o.placeShip(u,i[0],i[1],c),x(d,u,i[0],i[1],c)}await S().then(async()=>{console.log("readyToStart ended");let r=!1;for(setTimeout(()=>alert("Choose your target!"),1e3);!r;)await C(d,l,a).then(async()=>{o.areAllShipsSunk()==!0&&(alert("You win!"),r=!0,f()),await C(n,l,a).then(()=>{e.areAllShipsSunk()==!0&&(alert("Computer win!"),r=!0,f())})})})});})();
