"use strict";(()=>{function v(){let n=document.querySelector("body"),o=document.createElement("h1");o.style.fontFamily="Pixelify Sans, Rubik Broken Fax",o.textContent="BattleShip",o.classList.add("text-5xl","font-extrabold","text-center","mb-10","mt-10"),n?.appendChild(o);let e=document.createElement("div");e.setAttribute("id","gameLayout"),e.classList.add("flex","w-full","h-full","gap-10","p-10"),n?.appendChild(e);let r=document.createElement("div");r.setAttribute("id","playerBoard"),r.classList.add("grid","column-gap-0","border-2","border-black","mx-auto","my-auto"),w(r),e.appendChild(r);let a=document.createElement("div");a.setAttribute("id","computerBoard"),a.classList.add("grid","column-gap-0","border-2","border-black","mx-auto","my-auto"),w(a),e.appendChild(a)}function w(n){for(let o=0;o<10;o++){for(let e=0;e<10;e++){let r=document.createElement("div");r.classList.add("w-10","h-10","border-2","border-black"),r.setAttribute("row",`${o}`),r.setAttribute("col",`${e}`),r.setAttribute("id","square"),r.innerHTML="",n.appendChild(r)}n.style.gridTemplateColumns="repeat(10, [col-start] 1fr [col-end])"}}function k(){let n=document.querySelector("body"),o=document.createElement("modal");o.setAttribute("id","modal");let e=document.createElement("div");e.classList.add("fixed","left-0","top-0","flex","h-full","w-full","items-center","justify-center","bg-black","bg-opacity-50","py-10"),o.appendChild(e);let r=document.createElement("div");r.classList.add("max-h-full","w-full","max-w-xl","overflow-y-auto","sm:rounded-2xl","bg-white"),e.appendChild(r);let a=document.createElement("div");a.classList.add("w-full"),r.appendChild(a);let c=document.createElement("div");c.classList.add("m-8","my-20","max-w-[400px]","mx-auto"),a.appendChild(c);let s=document.createElement("div");s.classList.add("mb-8","text-center"),c.appendChild(s);let m=document.createElement("h1");m.classList.add("mb-4","text-3xl","font-extrabold"),m.textContent="BattleShip Game",s.appendChild(m);let i=document.createElement("p");i.classList.add("text-gray-600"),i.textContent="Embark on an epic naval adventure, a thrilling Battleship game that pits you against an intelligent opponent in a strategic battle for naval supremacy.",s.appendChild(i);let t=document.createElement("div");t.classList.add("space-y-4"),c.appendChild(t);let l=document.createElement("button");l.classList.add("p-3","bg-black","rounded-full","text-white","w-full","font-semibold"),l.textContent="Start Game",l.setAttribute("id","startButton"),l.addEventListener("click",()=>{o.remove(),setTimeout(()=>{alert("On horizontal, place the ship from left to right!")},1e3),setTimeout(()=>{alert("Place your first ship of 1 square length!")},1e3)}),t.appendChild(l),n?.appendChild(o)}var g=n=>{let o=Array.from({length:10},()=>Array(10).fill("")),e=[],r=[],a=document.getElementById(`${n}`),c=(t,l,d,p)=>{if(m(t,l,d,p)){let b=[];for(let u=0;u<t.length;u++){let h=p?l+u:l,f=p?d:d+u;o[h][f]="#",a?.querySelector(`[row="${h}"][col="${f}"]`)?.classList.add("bg-green-500"),b.push({row:h,col:f})}t.coordinates=b,e.push(t)}else console.log("Invalid ship placement")},s=(t,l)=>{if(o[t][l]==="#"){let p=e.find(b=>b.coordinates.some(u=>u.row===t&&u.col===l));p&&p.hit()}else r.push({row:t,col:l}),console.log("Missed the target!")},m=(t,l,d,p)=>{let b=p?l+t.length-1:l,u=p?d:d+t.length-1;if(b>=10||u>=10)return!1;for(let h=l;h<=b;h++)for(let f=d;f<=u;f++)if(o[h][f]==="#")return!1;return!0};return{placeShip:c,receiveAttack:s,areAllShipsSunk:()=>e.every(t=>t.isSunk===!0),grid:o,ships:e,missedAttacks:r}};var S=n=>({attack(o,e){n.receiveAttack(o,e)}}),C=n=>{let o=[],e,r=B();if(r.length>0){let a=Math.floor(Math.random()*r.length),{row:c,col:s}=r[a];o.push({row:c,col:s}),e={row:c,col:s}}else console.log("No available coordinates");return{attack(){n.receiveAttack(e.row,e.col)}}};function B(){let n=[];for(let o=0;o<10;o++)for(let e=0;e<10;e++)n.some(a=>a.row===o&&a.col===e)||n.push({row:o,col:e});return n}var y=n=>({length:n,coordinates:[],hits:0,isSunk:!1,hit(){this.hits+=1,this.hits===this.length?(this.isSunk=!0,console.log("Ship is sunck")):console.log("Ship hit")}});var A=()=>{let n=0;return new Promise(o=>{let e=document.getElementById("playerBoard"),r=[],a,c,s=!1,m=0,i=t=>{if(n===0)a=t.target;else if(n===1){if(c=t.target,a.getAttribute("row")===c.getAttribute("row")){m=Math.abs(Number(a.getAttribute("col"))-Number(c.getAttribute("col"))),s=!1;let l=Number(a.getAttribute("row")),d=Number(a.getAttribute("col"));r.push(m+1,s,l,d)}else if(a.getAttribute("col")===c.getAttribute("col")){m=Math.abs(Number(a.getAttribute("row"))-Number(c.getAttribute("row"))),s=!0;let l=Number(a.getAttribute("row")),d=Number(a.getAttribute("col"));r.push(m+1,s,l,d)}}n++,n===2&&(e?.removeEventListener("click",i),o(r))};e?.addEventListener("click",i)})},x=()=>Math.floor(Math.random()*9)+1;document.addEventListener("DOMContentLoaded",async()=>{k(),v();let n=document.getElementById("playerBoard"),o=document.getElementById("computerBoard"),e=n?n.getAttribute("id")?.toString():"",r=o?o.getAttribute("id")?.toString():"",a=g(e||""),c=g(r||""),s=S(a),m=C(c);for(let i=1;i<6;i++){let t=await A();console.log(t[0],t[1],"row: "+t[2],"col: "+t[3]),t[0]!=i?(alert("Invalid ship length, please try again"),i--):(i>=1&&i<5&&alert("Place the next ship of "+(i+1)+" square length!"),a.placeShip(y(i),t[2],t[3],t[1]))}for(let i=1;i<6;i++){let t=x(),l=x(),d=!1;(l>=5||t>=5)&&(d=!0),c.placeShip(y(i),t,l,d),console.log(t,l,d)}});})();
