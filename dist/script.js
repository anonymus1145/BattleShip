"use strict";(()=>{function S(){let n=document.querySelector("body"),o=document.createElement("h1");o.style.fontFamily="Pixelify Sans, Rubik Broken Fax",o.textContent="BattleShip",o.classList.add("text-5xl","font-extrabold","text-center","mb-10","mt-10"),n?.appendChild(o);let t=document.createElement("div");t.setAttribute("id","gameLayout"),t.classList.add("flex","w-full","h-full","gap-10","p-10"),n?.appendChild(t);let a=document.createElement("div");a.setAttribute("id","playerBoard"),a.classList.add("grid","column-gap-0","border-2","border-black","mx-auto","my-auto"),w(a),t.appendChild(a);let l=document.createElement("div");l.setAttribute("id","computerBoard"),l.classList.add("grid","column-gap-0","border-2","border-black","mx-auto","my-auto"),w(l),t.appendChild(l)}function w(n){for(let o=0;o<10;o++){for(let t=0;t<10;t++){let a=document.createElement("div");a.classList.add("w-10","h-10","border-2","border-black"),a.setAttribute("row",`${o}`),a.setAttribute("col",`${t}`),a.setAttribute("id","square"),a.innerHTML="",n.appendChild(a)}n.style.gridTemplateColumns="repeat(10, [col-start] 1fr [col-end])"}}function k(){let n=document.querySelector("body"),o=document.createElement("modal");o.setAttribute("id","modal");let t=document.createElement("div");t.classList.add("fixed","left-0","top-0","flex","h-full","w-full","items-center","justify-center","bg-black","bg-opacity-50","py-10"),o.appendChild(t);let a=document.createElement("div");a.classList.add("max-h-full","w-full","max-w-xl","overflow-y-auto","sm:rounded-2xl","bg-white"),t.appendChild(a);let l=document.createElement("div");l.classList.add("w-full"),a.appendChild(l);let s=document.createElement("div");s.classList.add("m-8","my-20","max-w-[400px]","mx-auto"),l.appendChild(s);let c=document.createElement("div");c.classList.add("mb-8","text-center"),s.appendChild(c);let e=document.createElement("h1");e.classList.add("mb-4","text-3xl","font-extrabold"),e.textContent="BattleShip Game",c.appendChild(e);let r=document.createElement("p");r.classList.add("text-gray-600"),r.textContent="Embark on an epic naval adventure, a thrilling Battleship game that pits you against an intelligent opponent in a strategic battle for naval supremacy.",c.appendChild(r);let d=document.createElement("div");d.classList.add("space-y-4"),s.appendChild(d);let i=document.createElement("button");i.classList.add("p-3","bg-black","rounded-full","text-white","w-full","font-semibold"),i.textContent="Start Game",i.setAttribute("id","startButton"),i.addEventListener("click",()=>{o.remove(),setTimeout(()=>{alert("On horizontal, place the ship from left to right and on ascending order!")},1e3),setTimeout(()=>{alert("Place your first ship of 1 square length!")},1e3)}),d.appendChild(i),n?.appendChild(o)}function v(){let n=document.querySelector("body"),o=document.createElement("modal");o.setAttribute("id","modal");let t=document.createElement("div");t.classList.add("fixed","left-0","top-0","flex","h-full","w-full","items-center","justify-center","bg-black","bg-opacity-50","py-10"),o.appendChild(t);let a=document.createElement("div");a.classList.add("max-h-full","w-full","max-w-xl","overflow-y-auto","sm:rounded-2xl","bg-white"),t.appendChild(a);let l=document.createElement("div");l.classList.add("w-full"),a.appendChild(l);let s=document.createElement("div");s.classList.add("m-8","my-20","max-w-[400px]","mx-auto"),l.appendChild(s);let c=document.createElement("div");c.classList.add("mb-8","text-center"),s.appendChild(c);let e=document.createElement("h1");e.classList.add("mb-4","text-3xl","font-extrabold"),e.textContent="Ready to play?",c.appendChild(e);let r=document.createElement("p");r.classList.add("text-gray-600"),c.appendChild(r);let d=document.createElement("div");d.classList.add("space-y-4"),s.appendChild(d);let i=document.createElement("button");i.classList.add("p-3","bg-black","rounded-full","text-white","w-full","font-semibold"),i.textContent="Start",i.setAttribute("id","startButton"),i.addEventListener("click",()=>{o.remove()}),d.appendChild(i),n?.appendChild(o)}var f=()=>{let n=Array.from({length:10},()=>Array(10).fill("")),o=[],t=[],a=(e,r,d,i)=>{if(s(e,r,d,i)){let u=[];for(let m=0;m<e.length;m++){let p=i?r+m:r,b=i?d:d+m;n[p][b]="#",u.push({row:p,col:b})}e.coordinates=u,o.push(e)}else console.log("Invalid ship placement")},l=(e,r)=>{if(n[e][r]==="#"){let i=o.find(u=>u.coordinates.some(m=>m.row===e&&m.col===r));i&&i.hit()}else t.push({row:e,col:r}),console.log("Missed the target!")},s=(e,r,d,i)=>{let u=i?r+e.length-1:r,m=i?d:d+e.length-1;if(u>=10||m>=10)return!1;for(let p=r;p<=u;p++)for(let b=d;b<=m;b++)if(n[p][b]==="#")return!1;return!0};return{placeShip:a,receiveAttack:l,areAllShipsSunk:()=>o.every(e=>e.isSunk===!0),grid:n,ships:o,missedAttacks:t}};var y=n=>({attack(o,t){n.receiveAttack(o,t)}}),C=n=>{let o=[],t,a=A();if(a.length>0){let l=Math.floor(Math.random()*a.length),{row:s,col:c}=a[l];o.push({row:s,col:c}),t={row:s,col:c}}else console.log("No available coordinates");return{attack(){return n.receiveAttack(t.row,t.col),t}}};function A(){let n=[];for(let o=0;o<10;o++)for(let t=0;t<10;t++)n.some(l=>l.row===o&&l.col===t)||n.push({row:o,col:t});return n}var g=n=>({length:n,coordinates:[],hits:0,isSunk:!1,hit(){this.hits+=1,this.hits===this.length?(this.isSunk=!0,console.log("Ship is sunck")):console.log("Ship hit")}});var L=()=>{let n=0;return new Promise(o=>{let t=document.getElementById("playerBoard"),a=[],l,s,c=!1,e=0,r=d=>{if(n===0)l=d.target;else if(n===1){if(s=d.target,l.getAttribute("row")===s.getAttribute("row")){e=Math.abs(Number(l.getAttribute("col"))-Number(s.getAttribute("col"))),c=!1;let i=Number(l.getAttribute("row")),u=Number(l.getAttribute("col"));a.push(e+1,c,i,u)}else if(l.getAttribute("col")===s.getAttribute("col")){e=Math.abs(Number(l.getAttribute("row"))-Number(s.getAttribute("row"))),c=!0;let i=Number(l.getAttribute("row")),u=Number(l.getAttribute("col"));a.push(e+1,c,i,u)}}n++,n===2&&(t?.removeEventListener("click",r),o(a))};t?.addEventListener("click",r)})},h=()=>Math.floor(Math.random()*9)+1,x=(n,o,t,a,l)=>{for(let s=0;s<o.length;s++){let c=l?t+s:t,e=l?a:a+s;n?.querySelector(`[row="${c}"][col="${e}"]`)?.classList.add("bg-green-500")}};document.addEventListener("DOMContentLoaded",async()=>{k(),S();let n=document.getElementById("playerBoard"),o=document.getElementById("computerBoard"),t=f(),a=f(),l=y(t),s=C(a);for(let e=1;e<6;e++){let r=await L();if(r[0]!=e)alert("Invalid ship length, please try again"),e--;else{e>=1&&e<5&&alert("Place the next ship of "+(e+1)+" square length!");let d=g(e);t.placeShip(d,r[2],r[3],r[1]),x(n,d,r[2],r[3],r[1])}}for(let e=1;e<6;e++){let r=[],d=h(),i=h(),u=!1,m=[d,i];r.forEach(b=>{b===m&&(d=h(),i=h(),m=[d,i],r.push(m))}),m[0]>6?u=!1:(m[1]>6||Math.floor(Math.random()*2)===0&&(u=!1),u=!0);let p=g(e);a.placeShip(p,m[0],m[1],u),a.placeShip(p,m[0],m[1],u)===null&&e--,x(o,p,m[0],m[1],u)}v();let c=!0;for(;c===!0;){alert("Chose the square you want to attack"),o?.addEventListener("click",r=>{let d=r.target.getAttribute("row"),i=r.target.getAttribute("col");l.attack(d,i),a.receiveAttack(d,i),a.receiveAttack(d,i)!==null?(r.target.classList.add("bg-red-500"),r.target.classList.remove("bg-green-500")):r.target.classList.add("bg-gray-500"),a.areAllShipsSunk()&&(alert("You won!"),c=!1)});let e;e=s.attack()}});})();
